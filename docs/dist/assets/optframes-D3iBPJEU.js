import"./modulepreload-polyfill-_HzmMr5C.js";import{p as x,a as w}from"./shim-C4SHjc5J.js";import{g as C,a as R}from"./generate-LVWF5mo4.js";/*!
    war3-model v4.0.0
	https://github.com/4eb0da/war3-model
	Released under the MIT License.
*/document.addEventListener("DOMContentLoaded",function(){const d=document.querySelector(".container"),T=document.querySelector('.save[data-type="mdl"]'),S=document.querySelector('.save[data-type="mdx"]'),b=document.querySelector(".label"),g=document.querySelector(".log");let y,l,h;d.addEventListener("dragenter",function(o){y=o.target,d.classList.add("container_drag"),o.preventDefault()}),d.addEventListener("dragleave",function(o){o.target===y&&d.classList.remove("container_drag")}),d.addEventListener("dragover",function(o){o.preventDefault(),o.dataTransfer.dropEffect="copy"}),d.addEventListener("drop",function(o){o.preventDefault(),d.classList.remove("container_drag");const i=o.dataTransfer.files&&o.dataTransfer.files[0];if(!i)return;const t=new FileReader,e=i.name.indexOf(".mdx")>-1;h=i.name.replace(/\.[^.]+$/,""),t.onload=()=>{try{e?l=x(t.result):l=w(t.result)}catch(a){A(a);return}E()},e?t.readAsArrayBuffer(i):t.readAsText(i)}),[T,S].forEach(s=>{s.addEventListener("click",function(i){i.preventDefault();let t;const e=s.getAttribute("data-type")==="mdl";e?t=new Blob([C(l)],{type:"octet/stream"}):t=new Blob([R(l)],{type:"octet/stream"});const a=document.createElement("a");a.style.display="none",document.body.appendChild(a),a.href=URL.createObjectURL(t),a.download=h+(e?".mdl":".mdx"),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})});function D(){g.innerHTML=""}function v(s){const o=document.createElement("p");o.textContent=s,g.appendChild(o)}function E(){D(),v("Optimization is lossy, make sure to test result models");let s=0,o=0;const i=(e,a)=>{for(let n=0;n<e.Vector.length;++n)if(e.Vector[n]!==a.Vector[n])return!1;if(e.InTan){for(let n=0;n<e.InTan.length;++n)if(e.InTan[n]!==a.InTan[n])return!1;for(let n=0;n<e.OutTan.length;++n)if(e.OutTan[n]!==a.OutTan[n])return!1}return!0},t=(e,a)=>{const n=e[a],I=l.Sequences,q=l.GlobalSequences;if(!n||!n.Keys)return;s+=n.Keys.length;let f=[];const L=(u,K)=>{const c=[];for(const r of n.Keys)r.Frame>=u&&r.Frame<=K&&c.push(r);let m=null;const p=[];for(let r=0;r<c.length;++r)m?(i(c[r],m)&&(r+1===c.length||i(c[r],c[r+1]))||p.push(c[r]),m=c[r]):(m=c[r],p.push(c[r]));f=f.concat(p)};if(n.GlobalSeqId!==null)L(0,q[n.GlobalSeqId]);else for(const u of I)L(u.Interval[0],u.Interval[1]);o+=n.Keys.length-f.length,n.Keys=f};for(const e of l.Nodes)t(e,"Translation"),t(e,"Rotation"),t(e,"Scaling"),t(e,"Visibility"),t(e,"EmissionRate"),t(e,"Gravity"),t(e,"Latitude"),t(e,"LifeSpan"),t(e,"InitVelocity"),t(e,"Speed"),t(e,"Variation"),t(e,"Width"),t(e,"Length"),t(e,"AttenuationStart"),t(e,"AttenuationEnd"),t(e,"Color"),t(e,"Intensity"),t(e,"AmbIntensity"),t(e,"AmbColor"),t(e,"HeightAbove"),t(e,"HeightBelow"),t(e,"Alpha"),t(e,"TextureSlot");for(const e of l.Cameras)t(e,"TargetTranslation"),t(e,"Translation"),t(e,"Rotation");for(const e of l.TextureAnims)t(e,"Translation"),t(e,"Rotation"),t(e,"Scaling");for(const e of l.Materials)for(const a of e.Layers)t(a,"TextureID"),t(a,"Alpha");v(o+"/"+s+" frames removed"),d.classList.add("container_with-data")}function A(s){d.classList.remove("container_with-data"),b.textContent=s}});
